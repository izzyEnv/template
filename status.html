<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="theme-color" content="#06f" />
    <meta http-equiv="expires" content="-1" />

    <link rel="stylesheet" href="asset/style/output.css" />
    <title>Status | Hotspot</title>
  $(if advert-pending == 'yes')
    <script>
      var popup = "";
      function focusAdvert() {
        if (window.focus) popup.focus();
      }
      function openAdvert() {
        popup = open("$(link-advert)", "hotspot_advert", "");
        setTimeout("focusAdvert()", 1000);
      }
    </script>
    $(endif)
    <script>
      function openLogout() {
        if (window.name != "hotspot_status") return true;
        window.location.href = "login.html";
        open(
          "$(link-logout)",
          "hotspot_logout",
          "toolbar=0,location=0,directories=0,status=0,menubars=0,resizable=1,width=280,height=250",
        );
        window.close();
        return false;
      }
    </script>
  </head>

  <body $(if advert-pending == 'yes')onLoad="openAdvert()" $(endif)>
    <div
      class="flex min-h-screen items-center justify-center bg-white px-1 py-4"
    >
      <div
        class="animate-fadein relative mx-auto w-full max-w-md rounded-xl bg-gradient-to-br from-sky-300 via-sky-500 to-sky-300 p-4 shadow-xl md:p-6"
      >
        <div class="mb-4 text-center">
          <div class="mb-1 flex items-center justify-center gap-2">
            <!-- Icon user/profile -->
            <svg
              class="h-8 w-8 text-white/90 drop-shadow-sm"
              fill="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"
              />
            </svg>
            <h1
              class="text-xl font-extrabold text-white drop-shadow-lg md:text-2xl"
            >
              Hai, $(username)
            </h1>
          </div>
          <p class="text-base font-medium text-white ">
            <span id="salam">Good morning</span>, <span id="jam"></span>
          </p>
        </div>
        <div class="mb-4 grid grid-cols-2 gap-2">
          <div
            class="flex flex-col rounded-lg border border-fuchsia-200 bg-white p-2 shadow dark:bg-slate-700"
          >
            <span
              class="text-xs font-semibold text-fuchsia-600 "
              >IP Address</span
            >
            <span class="text-base font-bold text-sky-500">$(ip)</span>
          </div>
          <div
            class="flex flex-col rounded-lg border border-fuchsia-200 bg-white p-2 shadow dark:bg-slate-700"
          >
            <span
              class="text-xs font-semibold text-fuchsia-600 "
              >Waktu Berjalan</span
            >
            <span id="uptime" class="text-base font-bold text-sky-500">$(uptime)</span>
          </div>
          <div
            class="flex flex-col rounded-lg border border-fuchsia-200 bg-white p-2 shadow dark:bg-slate-700"
          >
            <span
              class="text-xs font-semibold text-fuchsia-600 "
              >Data Upload</span
            >
            <span id="bytes-out" class="text-base font-bold text-sky-500">$(bytes-out-nice)</span>
          </div>
          <div
            class="flex flex-col rounded-lg border border-fuchsia-200 bg-white p-2 shadow dark:bg-slate-700"
          >
            <span
              class="text-xs font-semibold text-fuchsia-600 "
              >Data Download</span
            >
            <span id="bytes-in" class="text-base font-bold text-sky-500">$(bytes-in-nice)</span>
          </div>
          <div
            class="col-span-2 flex flex-col rounded-lg border border-fuchsia-200 bg-white p-2 shadow dark:bg-slate-700"
          >
            <span
              class="text-xs font-semibold text-fuchsia-600 "
              >Sisa Kuota</span
            >
            <span id="remain-bytes-total" class="text-base font-bold text-sky-500"
              >$(if remain-bytes-total)$(remain-bytes-total-nice)$(else)Unlimited$(endif)</span
            >
          </div>
        </div>
        <form
          action="$(link-logout)"
          name="logout"
          onSubmit="return openLogout()"
        >
          <button
            class="mt-1 flex w-full items-center justify-center rounded-md bg-gradient-to-r from-cyan-400 via-sky-400 to-cyan-400 py-2 text-lg font-bold text-white shadow-lg ring-0 "
          >
            Logout
          </button>
        </form>
      </div>
    </div>
    <script>
      // Jam digital
      function updateJam() {
        const now = new Date();
        const jam = now.toLocaleTimeString("en-US", { hour12: false });

        const jamElement = document.getElementById("jam");
        const salamElement = document.getElementById("salam");

        if (jamElement) {
          jamElement.textContent = jam;
        }

        // Ambil jam saja dari string waktu
        const hour = now.getHours(); // Mendapatkan jam dalam format number

        if (salamElement) {
          if (hour >= 5 && hour < 10) {
            salamElement.textContent = "Selamat Pagi";
          } else if (hour >= 10 && hour < 16) {
            salamElement.textContent = "Selamat Siang";
          } else if (hour >= 16 && hour < 19) {
            salamElement.textContent = "Selamat Sore";
          } else {
            salamElement.textContent = "Selamat Malam";
          }
        }
      }

      // Tunggu DOM selesai dimuat sebelum menjalankan fungsi
      document.addEventListener("DOMContentLoaded", function () {
        updateJam();
        setInterval(updateJam, 1000);
      });
    </script>

    <script type="text/javascript">
    <!--
      var refresh = $(if refresh-timeout)true$(else)false$(endif);
      var timeout = $(if refresh-timeout-secs)$(refresh-timeout-secs)000$(else)60000$(endif);

      function doRefresh() {
        var request = new XMLHttpRequest();
        request.open("GET", "$(link-status)", true);
        request.onreadystatechange = function() {
          if (request.readyState == 4) {
            if (request.status == 200) {
              var response = request.responseText;
              var stats = {};
              var a = response.match(/([a-zA-Z0-9\-\_]+) = '([^']+)'/g);
              if (a) {
                for (var i = 0; i < a.length; i++) {
                  var parts = a[i].split(" = ");
                  stats[parts[0]] = parts[1].substring(1, parts[1].length - 1);
                }
              }

              var fields = {
                'uptime': 'uptime',
                'bytes-in-nice': 'bytes-in',
                'bytes-out-nice': 'bytes-out',
                'remain-bytes-total-nice': 'remain-bytes-total'
              };

              for (var field in fields) {
                if (stats[field] && document.getElementById(fields[field])) {
                  document.getElementById(fields[field]).innerHTML = stats[field];
                }
              }

              if (document.getElementById('remain-bytes-total') && !stats['remain-bytes-total-nice']) {
                document.getElementById('remain-bytes-total').innerHTML = 'Unlimited';
              }
            }
            if (refresh) setTimeout(doRefresh, timeout);
          }
        }
        request.send(null);
      }

      if (refresh) {
        setTimeout(doRefresh, timeout);
      }
    //-->
    </script>
  </body>
</html>